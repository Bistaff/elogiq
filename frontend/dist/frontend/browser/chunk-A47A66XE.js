import{c as n,d as w,e as h,f as E,g as O,h as C,i as I,j as g,k as j}from"./chunk-CDMAQBYZ.js";import{F as m,R as c,T as u,X as d,a as R,aa as l,b as x,ba as b,c as L,f as s,t as p,uc as f}from"./chunk-JNUWSLK2.js";var y=class t extends C{constructor(e){super(e,"companies");this.http=e}get(){return this.execute({}).pipe(p(e=>e),m(e=>{throw e}))}getCompany(e){let a=`${e.companyId}/`;return this.executeSub(`${a}`,{}).pipe(p(i=>i),m(i=>{throw i}))}static \u0275fac=function(a){return new(a||t)(l(f))};static \u0275prov=d({token:t,factory:t.\u0275fac,providedIn:"root"})};var P=class t extends C{constructor(e){super(e,"product");this.http=e}get(e){let a={companyId:e.companyId,productId:e.productId},i=`holdingCost=${e.holdingCost}&setupCost=${e.setupCost}`;return e.annualDemand&&(i=`${i}&annualDemand=${e.annualDemand}`),this.execute({params:i,urlPathParams:a}).pipe(p(o=>o),m(o=>{throw o}))}static \u0275fac=function(a){return new(a||t)(l(f))};static \u0275prov=d({token:t,factory:t.\u0275fac,providedIn:"root"})};var A={companies:[],error:"",isLoading:!1,selectedCompany:null},_=w({providedIn:"root"},O(A),h(()=>({companiesService:b(y),productService:b(P)})),E(a=>{var i=a,{companiesService:t,productService:v}=i,e=L(i,["companiesService","productService"]);return{getCompanies:I(s(u(()=>n(e,{isLoading:!0})),c(()=>t.get().pipe(g({next:o=>{n(e,{companies:o,isLoading:!1})},error:o=>{console.error("Error during get companies: ",o),n(e,{isLoading:!1,error:o})}}))))),getCompany:I(s(u(()=>n(e,{isLoading:!0})),c(o=>t.getCompany(o).pipe(g({next:r=>{console.log("[CompaniesStore] Response: ",r),n(e,{selectedCompany:r,isLoading:!1})},error:r=>{n(e,{isLoading:!1,error:r}),console.error("Error during get company: ",r)}}))))),getProduct:I(s(u(()=>n(e,{isLoading:!0})),c(o=>v.get(o).pipe(g({next:r=>{console.log("[CompaniesStore] Product response: ",r),n(e,{selectedCompany:x(R({},e.selectedCompany()),{products:e.selectedCompany()?.products?.map(S=>S.id===r.id?r:S)||[]}),isLoading:!1})},error:r=>{n(e,{isLoading:!1,error:r}),console.error("Error during get company: ",r)}})))))}}),h(({isLoading:t})=>({isLoading$:j(t)})));export{_ as a};
